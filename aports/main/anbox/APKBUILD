pkgname=anbox
pkgver=0_git20180302
pkgrel=0
_commit="7de9d551df9820253878eb2611be02261f7937dc"
pkgdesc="Android in a box"
url="https://github.com/anbox/anbox"
arch="all"
license="GPLv3"
depends="dbus-libs boost boost-filesystem boost-iostreams boost-program_options boost-system protobuf-c sdl2 sdl2_image glib mesa-gles mesa-egl"
makedepends="cmake boost-dev sdl2-dev sdl2_image-dev libcap-dev protobuf-dev protobuf-c-dev glib-dev mesa-dev dbus-cpp-dev"
install=""
subpackages="$pkgname-dev $pkgname-doc"
source="
	anbox.initd
	anbox.confd
	$pkgname-${_commit}.tar.gz::https://github.com/anbox/anbox/archive/${_commit}.tar.gz
"

builddir="$srcdir"/$pkgname-${_commit}

prepare() {
	default_prepare
	mkdir "$builddir"/build
	cd "$builddir"/build
	cmake ..
}

build() {
	cd "$builddir"/build
	make
}

package() {
	cd "$builddir"

	install -m755 -D "$srcdir"/$pkgname.initd \
		"$pkgdir"/etc/init.d/$pkgname || return 1
	install -m644 -D "$srcdir"/$pkgname.confd \
		"$pkgdir"/etc/conf.d/$pkgname || return 1
}

sha512sums="512331fd6b4c5621c14b8bf07a94b2318dc33fea245de1e66d6385e1dc4cbfde7cb0d53507b46c85a11defe65a936cca40ace80df76130c7af2ef5999899892c  anbox.initd
f11f0d192cd7823307c2ce4ddc7b3fff5190f72d3f65a5524b487021a95a222aca1fd36ab1eb58ed533e7acd555bfb70f0c8a13db20338ea31527f3151fd2bd7  anbox.confd
cdb9970c1684cd66b4bdf7ff870aba304d6a604c2159e99f0fe81bcc9dd68cb50ec23b82c69a95db37da041502e38793922c8dd4ed3b6468dcf678c7c1743c46  anbox-7de9d551df9820253878eb2611be02261f7937dc.tar.gz"
